<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script type="text/javascript">
  	$(document).ready(function(){
	    $('[data-toggle="tooltip"]').tooltip();
	});
  </script>
</head>
<body>

<div class="container main-container">

{% block form %}{% endblock %}

{% if test %}
<div class="bs-callout bs-callout-info stats">
	<h3>Test stats summary</h3>
	<p>Average rounds: {{ test.stats.average_rounds }}</p>
	<h4>Winners</h4>
	{% for key, wins in test.stats.most_winner %}
		<p>{{ key }}: {{ wins }}</p>
	{% endfor %}
</div>
<div id="accordion" class="panel-group">
	{% for battle in test.battles %}
		<div class="panel panel-info">
			<div class="panel-heading">
				<h2 class="panel-title">
					<a data-toggle="collapse" href="#collapse-{{ loop.index }}" data-parent="#accordion">Battle #{{ loop.index }} has been won by {{ battle.winner }} in {{ battle.rounds_num }} rounds </a>
				</h2>
			</div>
			<div id="collapse-{{ loop.index }}" class="panel-collapse collapse">
				<div class="panel-body">
				{% for round in battle.rounds %}
					<div class="list-group round">
						<h3 class="list-group-item active round-num">Round {{round.num}}</h3>
						{% for action in round.actions %}
							<div class="list-group-item attack {{ action.success == true ? 'success' : '' }}">
								<h4 class="list-group-item-heading"><span class="weak">{{ action.attacker.name }} attacks with</span> {{ action.attacker.roll }}</h4>
								<div class="result">
									{% if action.success == true %}
										<p class="list-group-item-text">{{ action.enemy.name }} suffers
											<span class="label {{ action.enemy.hpdamage > 0 ? 'label-warning' : 'label-default'}}">{{ action.enemy.hpdamage }} HP</span> and
											<span class="label {{ action.enemy.defdamage > 0 ? 'label-warning' : 'label-default'}}">{{ action.enemy.defdamage }} Def</span></p>
									{% else %}
										<p class="label label-danger">miss</p>
									{% endif %}
								</div>
							</div>
						{% endfor %}
						<div class="list-group-item round-stats">
							<p>{{ round.stats.c1_name }} has <span class="label label-default">{{ round.stats.c1_hp }} HP</span> and <span class="label label-default">{{ round.stats.c1_def }} Def</span></p>
							<p>{{ round.stats.c2_name }} has <span class="label label-default">{{ round.stats.c2_hp }} HP</span> and <span class="label label-default">{{ round.stats.c2_def }} Def</span></p>
						</div>
					</div>
				{% endfor %}
				</div><!-- .card-block -->
			</div><!-- #collapse-{{ loop.index }} -->
		</div><!-- .panel -->
	{% endfor %}
</div><!-- .panel-group -->
{% endif %}

</div><!-- .container -->

</body>
</html>